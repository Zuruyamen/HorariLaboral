name: PVCat Automation Bot

on:
  schedule:
    # CRON Format: (Minute Hour Day Month Day_of_Week)
    # GitHub Actions uses UTC time. Spain (Winter) is UTC+1.

    # TUESDAYS: Target 09:30 and 13:30
    # Set to 09:12 and 13:12 Spain Time (08:12 and 12:12 UTC)
    - cron: '12 8 * * 2'
    - cron: '12 12 * * 2'

    # FRIDAYS: Target 16:00 and 18:00
    # Set to 15:42 and 17:42 Spain Time (14:42 and 16:42 UTC)
    - cron: '42 14 * * 5'
    - cron: '42 16 * * 5'

    # SATURDAYS: Target 10:30 and 19:30
    # Set to 10:11 and 19:11 Spain Time (09:11 and 18:11 UTC)
    - cron: '11 9 * * 6'
    - cron: '11 18 * * 6'

    # SUNDAYS: Target 10:30 and 19:30
    # Set to 10:11 and 19:11 Spain Time (09:11 and 18:11 UTC)
    - cron: '11 9 * * 0'
    - cron: '11 18 * * 0'
    
  workflow_dispatch: # Allows manual trigger from the GitHub Actions tab

jobs:
  punch-clock:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository code
        uses: actions/checkout@v4

      - name: Set up Python environment
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          pip install selenium webdriver-manager

      - name: Execute punch-clock script
        env:
          # Make sure to set these in Settings > Secrets and variables > Actions
          USER_PVCAT: ${{ secrets.USER_PVCAT }}
          PASS_PVCAT: ${{ secrets.PASS_PVCAT }}
        run: python fichar.py
